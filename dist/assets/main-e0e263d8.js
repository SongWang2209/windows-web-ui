var e=Object.defineProperty,__publicField=(s,t,a)=>(((s,t,a)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a})(s,"symbol"!=typeof t?t+"":t,a),a);import{d as s,r as t,c as a,o as n,b as o,i,j as l,F as p,k as d,h as u,u as r,l as c,n as v,A as h,e as y,t as g,f as m,T as x,m as f,_ as w,q as M,s as A,p as _,g as k,a as z,w as I}from"./index-cef210c6.js";class PosEntity{constructor(){__publicField(this,"x",0),__publicField(this,"y",0)}setX(e){return this.x=e,this}setY(e){return this.y=e,this}}const P=["onMousedown","onMousemove"],b={class:"icon"},$={style:{height:"100%",width:"100%"},"aria-hidden":"true"},B=["xlink:href"],S={class:"name"},E=w(s({__name:"Desktop",setup(e){function getPosByIndex(e){return(new PosEntity).setX(Math.floor(e/h.columnAppNum)*h.appSize).setY(e%h.columnAppNum*h.appSize)}const s=t(new PosEntity);function onMouseMove(e){c().dragApp.id&&(w.value=!0);const t=e.x>h.appSize/2?e.x-h.appSize/2:0,a=e.y>h.appSize/2?e.y-h.appSize/2:0;s.value.setX(t).setY(a)}const w=t(!1),M=t(0),A=a((()=>c().appList.findIndex((e=>e.id===c().dragApp.id))));const _=t(null);function onMouseUp(){Date.now()-M.value<=300&&function onClick(){c().dragApp.onAction()}(),w.value=!1,c().setDragApp(new f)}return(e,t)=>(n(),o("div",{id:"desktop",class:"desktop",onMousemove:onMouseMove,onMouseup:onMouseUp},[i(x,{tag:"div",name:"appList"},{default:l((()=>[(n(!0),o(p,null,d(r(c)().appList,((e,t)=>(n(),o("div",{key:e.name,class:u(["appitem",e.id===r(c)().dragApp.id&&"drag"]),style:v({width:`${r(h).appSize}px`,height:`${r(h).appSize}px`,left:`${e.id===r(c)().dragApp.id&&w.value?s.value.x:getPosByIndex(t).x}px`,top:`${e.id===r(c)().dragApp.id&&w.value?s.value.y:getPosByIndex(t).y}px`}),onMousedown:s=>function onMousedown(e){console.log("mousedown"),M.value=Date.now(),c().setDragApp(e)}(e),onMousemove:a=>function onItemMove(e,t){if(_.value)return;_.value=!0;const a=getPosByIndex(t);c().dragApp.id!==e.id&&w.value&&Math.abs(s.value.x-a.x)<=24&&Math.abs(s.value.y-a.y)<=24&&c().changeAppListIndex(e),setTimeout((()=>{_.value=!1}),100)}(e,t)},[y("div",b,[(n(),o("svg",$,[y("use",{"xlink:href":`#${e.icon}`},null,8,B)]))]),y("div",S,g(e.name),1)],46,P)))),128)),w.value?(n(),o("div",{key:0,class:"fake",style:v({width:`${r(h).appSize}px`,height:`${r(h).appSize}px`,left:`${getPosByIndex(A.value).x}px`,top:`${getPosByIndex(A.value).y}px`})},null,4)):m("",!0)])),_:1})],32))}}),[["__scopeId","data-v-7663e314"]]),_withScopeId=e=>(_("data-v-ce695a5f"),e=e(),k(),e),C={class:"footer"},L=_withScopeId((()=>y("div",{class:"part size-1"},null,-1))),D={class:"part"},N=_withScopeId((()=>y("div",{class:"snapshot"},null,-1))),U=["onMouseover"],j={style:{height:"30px",width:"30px"},"aria-hidden":"true"},T=["xlink:href"],X=_withScopeId((()=>y("div",{class:"part size-2"},null,-1))),Y=_withScopeId((()=>y("div",{class:"part size-2"},null,-1))),F=w(s({__name:"Footer",setup:e=>(e,s)=>{const t=M("el-popover");return n(),o("div",C,[L,y("div",D,[(n(!0),o(p,null,d(r(c)().openAppPool,((e,s)=>(n(),A(t,{key:e.id,width:"auto",placement:"top",trigger:"hover"},{reference:l((()=>[y("div",{class:"pool-icon",onMouseover:t=>function getElementByApp(e,s){var t;const a=document.getElementsByClassName("snapshot")[s];for(;null==a?void 0:a.firstChild;)null==a||a.removeChild(null==a?void 0:a.firstChild);const n=null==(t=document.getElementById(`APP_${e.id}`))?void 0:t.cloneNode(!0);n.style.position="relative",n.style.inset="0",n.style.width="300px",n.style.height="200px",n.classList.remove("mini"),n.style.zIndex="1",null==a||a.appendChild(n);const o=document.createElement("div");o.style.position="absolute",o.style.inset="0",o.style.background="rgba(0,0,0,0.1)",o.style.zIndex="2",null==a||a.appendChild(o)}(e,s)},[(n(),o("svg",j,[y("use",{"xlink:href":`#${e.icon}`},null,8,T)]))],40,U)])),default:l((()=>[N])),_:2},1024)))),128))]),X,Y])}}),[["__scopeId","data-v-ce695a5f"]]),q={class:"main"},O=w(s({__name:"main",setup(e){const s=t(!0);return setTimeout((()=>{s.value=!1}),1e3),window.addEventListener("storage",(e=>{"bgUrl"===e.key&&c().setBgUrl(e.newValue)})),(e,t)=>{const a=z("loading");return I((n(),o("div",q,[i(E),i(F)])),[[a,s.value]])}}}),[["__scopeId","data-v-6c6a0fc5"]]);export{O as default};
